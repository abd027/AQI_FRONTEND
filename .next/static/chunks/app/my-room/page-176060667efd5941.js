(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[471],{4242:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var a=t(95155),r=t(12115),l=t(62833),i=t(36364),n=t(71349),d=t(86948),c=t(3998),o=t(65142),m=t(76444),x=t(18332),u=t(8595),h=t(92033),p=t(78770),f=t(50984),j=t(13381),v=t(37915),g=t(66874),N=t(24467),y=t(91851);let w=(0,t(14294).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var b=t(63263);let A="https://aqi-backend-gohs.onrender.com || http://localhost:8000";function k(){let e=localStorage.getItem("access_token"),s={"Content-Type":"application/json"};return e&&(s.Authorization="Bearer ".concat(e)),s}function _(){let{user:e}=(0,l.A)(),[s,t]=(0,r.useState)([]),[_,T]=(0,r.useState)(!0),[C,M]=(0,r.useState)(null),[F,S]=(0,r.useState)({host:"127.0.0.1",port:1883,topic:"sensor/data",username:"",password:"",client_id:"",is_active:!0}),[R,Q]=(0,r.useState)(!0),[q,D]=(0,r.useState)(!1),[P,z]=(0,r.useState)(null),[E,J]=(0,r.useState)(!1),[L,H]=(0,r.useState)(1),[I]=(0,r.useState)(5),[Z,B]=(0,r.useState)(!0),$=async()=>{try{T(!0),M(null);let e=await fetch("".concat(A,"/api/sensor-readings/"),{headers:k()});if(!e.ok)throw Error("Failed to fetch sensor readings");let s=await e.json();t(s.results||s)}catch(e){M(e.message||"Failed to load sensor readings")}finally{T(!1)}},O=async()=>{try{Q(!0),z(null);let e=await fetch("".concat(A,"/api/mqtt-config/"),{headers:k()});if(!e.ok)throw Error("Failed to fetch MQTT configuration");let s=await e.json();S({host:s.host||"127.0.0.1",port:s.port||1883,topic:s.topic||"sensor/data",username:s.username||"",password:"***"===s.password?"":s.password||"",client_id:s.client_id||"",is_active:void 0===s.is_active||s.is_active})}catch(e){z(e.message||"Failed to load MQTT configuration")}finally{Q(!1)}},W=async()=>{try{D(!0),z(null),J(!1);let e=await fetch("".concat(A,"/api/mqtt-config/"),{method:"PUT",headers:k(),body:JSON.stringify(F)});if(!e.ok){let s=await e.json();throw Error(s.detail||"Failed to save MQTT configuration")}J(!0),setTimeout(()=>J(!1),3e3)}catch(e){z(e.message||"Failed to save MQTT configuration")}finally{D(!1)}};(0,r.useEffect)(()=>{e&&($(),O())},[e]),(0,r.useEffect)(()=>{if(!e||!Z)return;let s=setInterval(()=>{$()},25e3);return()=>clearInterval(s)},[e,Z]);let U=L*I,V=U-I,X=s.slice(V,U),G=Math.ceil(s.length/I);return(0,a.jsx)(i.A,{children:(0,a.jsx)(n.A,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:gap-6 p-4 md:p-6 lg:p-8",children:[(0,a.jsxs)("header",{className:"animate-slide-up flex-shrink-0",children:[(0,a.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight mb-2 flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-6 w-6"}),"My Room"]}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm md:text-base",children:"Monitor your room's air quality from sensor data"})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3 animate-slide-up",style:{animationDelay:"0.1s"},children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"MQTT Configuration"}),(0,a.jsx)(d.BT,{children:"Configure your MQTT broker connection"})]}),(0,a.jsx)(d.Wu,{className:"space-y-4",children:R?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(h.A,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,a.jsxs)(a.Fragment,{children:[P&&(0,a.jsxs)(x.Fc,{variant:"destructive",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsx)(x.TN,{children:P})]}),E&&(0,a.jsxs)(x.Fc,{children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsx)(x.TN,{children:"Configuration saved successfully!"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"host",children:"Host / IP Address *"}),(0,a.jsx)(o.p,{id:"host",value:F.host,onChange:e=>S({...F,host:e.target.value}),placeholder:"127.0.0.1"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"port",children:"Port *"}),(0,a.jsx)(o.p,{id:"port",type:"number",value:F.port,onChange:e=>S({...F,port:parseInt(e.target.value)||1883}),placeholder:"1883"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"topic",children:"Topic *"}),(0,a.jsx)(o.p,{id:"topic",value:F.topic,onChange:e=>S({...F,topic:e.target.value}),placeholder:"sensor/data"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"username",children:"Username (optional)"}),(0,a.jsx)(o.p,{id:"username",value:F.username,onChange:e=>S({...F,username:e.target.value}),placeholder:"MQTT username"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"password",children:"Password (optional)"}),(0,a.jsx)(o.p,{id:"password",type:"password",value:F.password,onChange:e=>S({...F,password:e.target.value}),placeholder:"MQTT password"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"client_id",children:"Client ID (optional)"}),(0,a.jsx)(o.p,{id:"client_id",value:F.client_id,onChange:e=>S({...F,client_id:e.target.value}),placeholder:"MQTT client ID"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"is_active",checked:F.is_active,onChange:e=>S({...F,is_active:e.target.checked}),className:"rounded border-gray-300"}),(0,a.jsx)(m.J,{htmlFor:"is_active",className:"cursor-pointer",children:"Active"})]}),(0,a.jsx)(c.$,{onClick:W,disabled:q,className:"w-full",children:q?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):"Save Configuration"})]})})]})}),(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ZB,{children:"Sensor Readings"}),(0,a.jsx)(d.BT,{children:"Latest sensor data from your MQTT broker"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>B(!Z),className:Z?"bg-primary/10":"",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 ".concat(Z?"animate-spin":"")}),(0,a.jsx)("span",{className:"ml-2",children:Z?"Auto":"Manual"})]})})]})}),(0,a.jsxs)(d.Wu,{children:[_?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(h.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):C?(0,a.jsxs)(x.Fc,{variant:"destructive",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),(0,a.jsx)(x.TN,{children:C})]}):0===s.length?(0,a.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"No sensor readings available yet. Make sure your MQTT listener is running."}):(0,a.jsx)("div",{className:"space-y-4",children:X.map(e=>{var s,t;return(0,a.jsx)(d.Zp,{className:"border",children:(0,a.jsxs)(d.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.received_at).toLocaleString()})}),null!==e.calculated_aqi&&(0,a.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-semibold",style:(s=e.calculated_aqi,t=e.aqi_color||null,s&&t?{backgroundColor:t,color:"#fff"}:{}),children:["AQI: ",e.calculated_aqi," - ",e.aqi_category||"Unknown"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[null!==e.temperature&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Temperature"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[e.temperature.toFixed(1),"\xb0C"]})]})]}),null!==e.humidity&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Humidity"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[e.humidity.toFixed(1),"%"]})]})]}),null!==e.co_ppm&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"CO"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[e.co_ppm.toFixed(2)," ppm"]})]})]}),null!==e.co2_ppm&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"CO₂"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[e.co2_ppm.toFixed(2)," ppm"]})]})]})]}),null!==e.ch4_ppm&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"CH₄ (Methane)"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[e.ch4_ppm.toFixed(2)," ppm"]})]})]})}),e.dominant_pollutant&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Dominant Pollutant: ",(0,a.jsx)("span",{className:"font-semibold",children:e.dominant_pollutant})]})})]})},e.id)})}),!_&&s.length>0&&(0,a.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",V+1,"-",Math.min(U,s.length)," of ",s.length," readings"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{H(e=>Math.max(e-1,1))},disabled:1===L,children:[(0,a.jsx)(w,{className:"h-4 w-4"}),"Previous"]}),(0,a.jsxs)("div",{className:"text-sm font-medium px-4",children:["Page ",L," of ",G]}),(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{H(e=>Math.min(e+1,G))},disabled:L===G,children:["Next",(0,a.jsx)(b.A,{className:"h-4 w-4"})]})]})]})]})]})})]})]})})})}},13381:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},18332:(e,s,t)=>{"use strict";t.d(s,{Fc:()=>d,TN:()=>o,XL:()=>c});var a=t(95155),r=t(12115),l=t(83101),i=t(64269);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,...l}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,i.cn)(n({variant:r}),t),...l})});d.displayName="Alert";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...r})});c.displayName="AlertTitle";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...r})});o.displayName="AlertDescription"},24467:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]])},32894:(e,s,t)=>{"use strict";t.d(s,{b:()=>d});var a=t(12115);t(47650);var r=t(32467),l=t(95155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let t=(0,r.TL)(`Primitive.${s}`),i=a.forwardRef((e,a)=>{let{asChild:r,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(r?t:s,{...i,ref:a})});return i.displayName=`Primitive.${s}`,{...e,[s]:i}},{}),n=a.forwardRef((e,s)=>(0,l.jsx)(i.label,{...e,ref:s,onMouseDown:s=>{var t;s.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));n.displayName="Label";var d=n},36364:(e,s,t)=>{"use strict";t.d(s,{A:()=>d});var a=t(95155),r=t(12115),l=t(20063),i=t(62833),n=t(92033);function d(e){let{children:s,requireVerified:t=!1}=e,{user:d,loading:c,isAuthenticated:o}=(0,i.A)(),m=(0,l.useRouter)();return((0,r.useEffect)(()=>{!c&&(o?t&&d&&!d.is_verified&&m.push("/verify-email"):m.push("/login"))},[c,o,d,t,m]),c)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"h-8 w-8 animate-spin text-primary"})}):!o||t&&d&&!d.is_verified?null:(0,a.jsx)(a.Fragment,{children:s})}},37915:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]])},50984:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},60124:(e,s,t)=>{Promise.resolve().then(t.bind(t,4242))},66874:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]])},76444:(e,s,t)=>{"use strict";t.d(s,{J:()=>c});var a=t(95155),r=t(12115),l=t(32894),i=t(83101),n=t(64269);let d=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.b,{ref:s,className:(0,n.cn)(d(),t),...r})});c.displayName=l.b.displayName},78770:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},86948:(e,s,t)=>{"use strict";t.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n});var a=t(95155),r=t(12115),l=t(64269);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});i.displayName="Card";let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});n.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},92033:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(14294).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}},e=>{e.O(0,[286,619,314,470,349,441,493,358],()=>e(e.s=60124)),_N_E=e.O()}]);