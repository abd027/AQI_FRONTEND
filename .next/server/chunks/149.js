"use strict";exports.id=149,exports.ids=[149],exports.modules={62186:(a,b,c)=>{c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b})).displayName="CardFooter"},78352:(a,b,c)=>{c.d(b,{$q:()=>j,A$:()=>o,BD:()=>p,CE:()=>m,H0:()=>i,HW:()=>n,Ky:()=>s,X4:()=>r,cC:()=>l,fetchAQIByCoordinates:()=>k,hY:()=>v,ni:()=>t,qH:()=>h,sh:()=>u,xw:()=>q});let d="https://aqi-backend-gohs.onrender.com || http://localhost:8000";function e(){return{"Content-Type":"application/json"}}function f(){}async function g(a,b={},c=3){let d=[300,700],h=e(),i={...b,headers:{...h,...b.headers||{}}};for(let b=0;b<c;b++)try{let e=new AbortController,g=setTimeout(()=>e.abort(),2e4),h=await fetch(a,{...i,signal:e.signal});if(401===h.status)return f(),null;if(clearTimeout(g),h.ok)return h;if(b<c-1){let a=d[b]||d[d.length-1];await new Promise(b=>setTimeout(b,a));continue}return h}catch(a){if(b<c-1&&("AbortError"===a.name||"TypeError"===a.name)){let a=d[b]||d[d.length-1];await new Promise(b=>setTimeout(b,a));continue}if(b===c-1)break}return null}function h(a){let b=a.current||{};return{city:a.city,aqi:a.aqi,category:a.category,healthAdvice:a.health_advice||a.healthAdvice||"",pollutants:[{name:"PM2.5",value:b.pm2_5??null,unit:"\xb5g/m\xb3"},{name:"PM10",value:b.pm10??null,unit:"\xb5g/m\xb3"},{name:"O₃",value:b.ozone??null,unit:"\xb5g/m\xb3"},{name:"NO₂",value:b.nitrogen_dioxide??null,unit:"\xb5g/m\xb3"},{name:"CO",value:b.carbon_monoxide??null,unit:"\xb5g/m\xb3"},{name:"SO₂",value:b.sulphur_dioxide??null,unit:"\xb5g/m\xb3"}].filter(a=>null!==a.value),weather:a.weather||void 0,lastUpdated:a.lastUpdated||a.last_updated||"",location:a.location,dominant_pollutant:a.dominant_pollutant,dominantPollutant:a.dominant_pollutant,color:a.color,current:b}}async function i(a="New York"){try{let b=await g(`${d}/api/aqi/trend?city=${encodeURIComponent(a)}`,{},3);if(!b||!b.ok)return console.warn(`Failed to fetch AQI trend data for ${a}: ${b?.statusText||"Unknown error"} (status: ${b?.status||"N/A"})`),[];let c=await b.json();return Array.isArray(c)?c:[]}catch(b){return console.error(`Error fetching AQI trend for ${a}:`,b),[]}}async function j(){try{let a=await g(`${d}/api/cities/rankings/`,{},3);if(!a||!a.ok)return console.warn("Failed to fetch city rankings"),[];let b=await a.json();if(Array.isArray(b))return b;return b.error&&console.error("Error in city rankings response:",b.detail||b.message),[]}catch(a){return console.error("Error fetching city rankings:",a),[]}}async function k(a,b,c){try{let e=await g(`${d}/api/aqi/coordinates?lat=${a}&lng=${b}`,{signal:c});if(!e||!e.ok)return console.warn(`Failed to fetch AQI data by coordinates: ${e?.statusText||"Unknown error"}`),null;let f=await e.json();return h(f)}catch(a){return console.error("Error fetching AQI data by coordinates:",a),null}}async function l(a,b,c){try{let e=await g(`${d}/api/aqi/enhanced?lat=${a}&lng=${b}`,{signal:c});if(!e||!e.ok)return console.warn(`Failed to fetch enhanced AQI data: ${e?.statusText||"Unknown error"}`),null;return await e.json()}catch(a){return console.error("Error fetching enhanced AQI data:",a),null}}async function m(a){try{let b=await g(`${d}/api/aqi/geocode/?city=${encodeURIComponent(a)}`);if(!b||!b.ok)return null;return await b.json()}catch(a){return console.error("Error geocoding city:",a),null}}async function n(){let a=await fetch(`${d}/api/auth/me`,{headers:e()});if(!a.ok)throw 401===a.status&&f(),Error("Failed to get current user");return await a.json()}async function o(a){let b=await fetch(`${d}/api/auth/verify-email/?token=${a}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!b.ok){let a=b.headers.get("content-type");if(a&&a.includes("application/json"))try{let a=await b.json();throw Error(a.detail||a.message||"Email verification failed")}catch(a){throw Error("Email verification failed")}else throw Error(`Email verification failed: ${b.status} ${b.statusText}`)}let c=b.headers.get("content-type");c&&c.includes("application/json")&&await b.json()}async function p(a){let b=await fetch(`${d}/api/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})});if(!b.ok)throw Error((await b.json()).detail||"Failed to send password reset email")}async function q(a,b){let c=await fetch(`${d}/api/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,new_password:b})});if(!c.ok)throw Error((await c.json()).detail||"Password reset failed")}async function r(){let a=await fetch(`${d}/api/aqi/subscriptions/`,{headers:{...e(),"Content-Type":"application/json"}});if(!a.ok)throw 401===a.status&&f(),Error((await a.json().catch(()=>({detail:"Failed to fetch subscriptions"}))).detail||"Failed to fetch subscriptions");let b=await a.json();return b&&"object"==typeof b&&"results"in b&&Array.isArray(b.results)?b.results:Array.isArray(b)?b:(console.warn("Unexpected subscriptions response format:",b),[])}async function s(a){let b=await fetch(`${d}/api/aqi/subscriptions/`,{method:"POST",headers:{...e(),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){b.status;let a=await b.json().catch(()=>({detail:"Failed to create subscription"}));if(400===b.status&&a.non_field_errors)throw Error(Array.isArray(a.non_field_errors)?a.non_field_errors[0]:a.non_field_errors);if(400===b.status){let b=Object.entries(a).filter(([a])=>"detail"!==a).map(([a,b])=>{let c=Array.isArray(b)?b[0]:b;return`${a}: ${c}`});if(b.length>0)throw Error(b.join(", "))}throw Error(a.detail||a.message||"Failed to create subscription")}return await b.json()}async function t(a){let b=await fetch(`${d}/api/aqi/subscriptions/${a}/`,{method:"DELETE",headers:{...e(),"Content-Type":"application/json"}});if(!b.ok)throw 401===b.status&&f(),Error((await b.json().catch(()=>({detail:"Failed to delete subscription"}))).detail||"Failed to delete subscription")}async function u(a){let b=await fetch(`${d}/api/aqi/subscriptions/${a}/toggle/`,{method:"PATCH",headers:{...e(),"Content-Type":"application/json"}});if(!b.ok)throw 401===b.status&&f(),Error((await b.json().catch(()=>({detail:"Failed to toggle subscription"}))).detail||"Failed to toggle subscription");return await b.json()}async function v(a,b){let c={};void 0!==b&&(c.aqi_value=b);let f=await fetch(`${d}/api/aqi/subscriptions/${a}/send_notification/`,{method:"POST",headers:{...e(),"Content-Type":"application/json"},body:Object.keys(c).length>0?JSON.stringify(c):void 0});if(!f.ok){f.status;let a="Failed to send notification";try{let b=await f.json();a=b.error||b.detail||a}catch(b){try{let b=await f.text();b&&(a=b)}catch(a){}}throw Error(a)}return await f.json()}}};