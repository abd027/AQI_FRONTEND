(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{1957:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var n=r(95155),o=r(12115),a=r(20063),s=r(52619),i=r.n(s),l=r(62833),c=r(3998),d=r(86948),u=r(18332),f=r(50984),m=r(78770),h=r(92033),p=r(53440),g=r(92689);function b(){let[e,t]=(0,o.useState)(""),[r,s]=(0,o.useState)(""),[b,y]=(0,o.useState)(""),[x,v]=(0,o.useState)(""),[w,j]=(0,o.useState)(""),[k,S]=(0,o.useState)(""),[N,_]=(0,o.useState)(void 0),[A,C]=(0,o.useState)(""),[P,E]=(0,o.useState)(!1),[R,I]=(0,o.useState)(!1),{register:O}=(0,l.A)(),T=(0,a.useRouter)(),q=async t=>{if(t.preventDefault(),C(""),E(!1),b!==x)return void C("Passwords do not match");if(b.length<8)return void C("Password must be at least 8 characters long");I(!0);try{await O(e,r,b,w||void 0,k||void 0,null==N?void 0:N.lat,null==N?void 0:N.lng),E(!0),setTimeout(()=>{T.push("/login")},3e3)}catch(e){C(e.message||"Registration failed")}finally{I(!1)}};return P?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:(0,n.jsx)(d.Zp,{className:"w-full max-w-md",children:(0,n.jsx)(d.Wu,{className:"pt-6",children:(0,n.jsxs)(u.Fc,{children:[(0,n.jsx)(f.A,{className:"h-4 w-4"}),(0,n.jsx)(u.TN,{children:"Registration successful! Please check your email to verify your account. Redirecting to login..."})]})})})}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:(0,n.jsxs)(d.Zp,{className:"w-full max-w-md",children:[(0,n.jsxs)(d.aR,{children:[(0,n.jsx)(d.ZB,{children:"Create Account"}),(0,n.jsx)(d.BT,{children:"Sign up to get started"})]}),(0,n.jsx)(d.Wu,{children:(0,n.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[A&&(0,n.jsxs)(u.Fc,{variant:"destructive",children:[(0,n.jsx)(m.A,{className:"h-4 w-4"}),(0,n.jsx)(u.TN,{children:A})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{htmlFor:"email",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Email"}),(0,n.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0,disabled:R,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{htmlFor:"username",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Username"}),(0,n.jsx)("input",{id:"username",type:"text",value:r,onChange:e=>s(e.target.value),required:!0,disabled:R,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{htmlFor:"password",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Password"}),(0,n.jsx)("input",{id:"password",type:"password",value:b,onChange:e=>y(e.target.value),required:!0,disabled:R,minLength:8,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("label",{htmlFor:"confirmPassword",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Confirm Password"}),(0,n.jsx)("input",{id:"confirmPassword",type:"password",value:x,onChange:e=>v(e.target.value),required:!0,disabled:R,minLength:8,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,n.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:"Location (Optional - for AQI alerts)"}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add your location to receive email alerts when air quality is unhealthy in your area. Your city will also be shown on the dashboard."}),(0,n.jsx)(p.A,{value:w,onChange:(e,t,r)=>{j(e),t&&S(t),r&&_(r)},disabled:R,placeholder:"Search for a city...",label:"City"}),(0,n.jsx)(g.A,{value:k,onChange:e=>{S(e)},disabled:R,placeholder:"Select or search for a country...",label:"Country"})]}),(0,n.jsx)(c.$,{type:"submit",className:"w-full",disabled:R,children:R?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Register"}),(0,n.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",(0,n.jsx)(i(),{href:"/login",className:"text-primary hover:underline",children:"Login"})]})]})})]})})}},3998:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var n=r(95155),o=r(12115),a=r(32467),s=r(83101),i=r(64269);let l=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary-gradient text-primary-foreground bg-primary-gradient-hover btn-glass border",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=o.forwardRef((e,t)=>{let{className:r,variant:o,size:s,asChild:c=!1,...d}=e,u=c?a.DX:"button";return(0,n.jsx)(u,{className:(0,i.cn)(l({variant:o,size:s,className:r})),ref:t,...d})});c.displayName="Button"},20063:(e,t,r)=>{"use strict";var n=r(47260);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},26615:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(14294).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},32467:(e,t,r)=>{"use strict";r.d(t,{DX:()=>u,TL:()=>d});var n,o=r(12115),a=r(94446),s=r(95155),i=Symbol.for("react.lazy"),l=(n||(n=r.t(o,2)))[" use ".trim().toString()];function c(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===i&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function d(e){let t=function(e){let t=o.forwardRef((e,t)=>{let{children:r,...n}=e;if(c(r)&&"function"==typeof l&&(r=l(r._payload)),o.isValidElement(r)){var s;let e,i,l=(s=r,(i=(e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.ref:(i=(e=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?s.props.ref:s.props.ref||s.ref),c=function(e,t){let r={...t};for(let n in t){let o=e[n],a=t[n];/^on[A-Z]/.test(n)?o&&a?r[n]=(...e)=>{let t=a(...e);return o(...e),t}:o&&(r[n]=o):"style"===n?r[n]={...o,...a}:"className"===n&&(r[n]=[o,a].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==o.Fragment&&(c.ref=t?(0,a.t)(t,l):l),o.cloneElement(r,c)}return o.Children.count(r)>1?o.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=o.forwardRef((e,r)=>{let{children:n,...a}=e;c(n)&&"function"==typeof l&&(n=l(n._payload));let i=o.Children.toArray(n),d=i.find(m);if(d){let e=d.props.children,n=i.map(t=>t!==d?t:o.Children.count(e)>1?o.Children.only(null):o.isValidElement(e)?e.props.children:null);return(0,s.jsx)(t,{...a,ref:r,children:o.isValidElement(e)?o.cloneElement(e,void 0,n):null})}return(0,s.jsx)(t,{...a,ref:r,children:n})});return r.displayName=`${e}.Slot`,r}var u=d("Slot"),f=Symbol("radix.slottable");function m(e){return o.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===f}},50984:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(14294).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},62833:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>l});var n=r(95155),o=r(12115),a=r(20063);let s=(0,o.createContext)(void 0),i="https://aqi-backend-gohs.onrender.com || http://localhost:8000";function l(e){let{children:t}=e,[r,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(!0),u=(0,a.useRouter)();(0,o.useEffect)(()=>{f()},[]);let f=async()=>{try{let e=localStorage.getItem("access_token");if(!e)return void d(!1);let t=await fetch("".concat(i,"/api/auth/me/"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();l(e)}else await m()}catch(e){console.error("Error loading user:",e)}finally{d(!1)}},m=(0,o.useCallback)(async()=>{try{let e=localStorage.getItem("refresh_token");if(!e)throw Error("No refresh token");let t=await fetch("".concat(i,"/api/auth/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(t.ok){let e=await t.json();localStorage.setItem("access_token",e.access_token),e.refresh_token&&localStorage.setItem("refresh_token",e.refresh_token),await f()}else await g()}catch(e){console.error("Error refreshing token:",e),await g()}},[]),h=async(e,t)=>{let r=await fetch("".concat(i,"/api/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)throw Error((await r.json()).detail||"Login failed");let n=await r.json();localStorage.setItem("access_token",n.access_token),localStorage.setItem("refresh_token",n.refresh_token),await f()},p=async(e,t,r,n,o,a,s)=>{let l=await fetch("".concat(i,"/api/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,username:t,password:r,password_confirm:r,city:n||null,country:o||null,latitude:a||null,longitude:s||null})});if(!l.ok){let e=await l.json();if(e.detail&&"object"==typeof e.detail&&!Array.isArray(e.detail))throw Error(Object.entries(e.detail).map(e=>{let[t,r]=e,n=t.replace(/_/g," "),o=Array.isArray(r)?r:[r];return"".concat(n,": ").concat(o.join(", "))}).join("\n"));throw Error("string"==typeof e.detail?e.detail:e.message||"Registration failed")}return await l.json()},g=async()=>{try{let e=localStorage.getItem("refresh_token");e&&await fetch("".concat(i,"/api/auth/logout/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})})}catch(e){console.error("Error during logout:",e)}finally{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),l(null),u.push("/login")}},b=(0,o.useCallback)(()=>(null==r?void 0:r.city)||null,[r]);return(0,n.jsx)(s.Provider,{value:{user:r,loading:c,login:h,register:p,logout:g,refreshToken:m,isAuthenticated:!!r,getUserCity:b},children:t})}function c(){let e=(0,o.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>a});var n=r(2821),o=r(75889);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,n.$)(t))}},65142:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});var n=r(95155),o=r(12115),a=r(64269);let s=o.forwardRef((e,t)=>{let{className:r,type:o,...s}=e;return(0,n.jsx)("input",{type:o,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...s})});s.displayName="Input"},71361:(e,t,r)=>{Promise.resolve().then(r.bind(r,1957))},83797:(e,t,r)=>{"use strict";function n(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}async function o(e,t){if(!e||e.length<2)return[];try{if(!localStorage.getItem("access_token"))return console.warn("No access token found for autocomplete"),[];let t=new URLSearchParams({q:e}),r=await fetch("".concat("https://aqi-backend-gohs.onrender.com || http://localhost:8000","/api/aqi/autocomplete/?").concat(t.toString()),{headers:function(){let e=localStorage.getItem("access_token"),t={"Content-Type":"application/json"};return e&&(t.Authorization="Bearer ".concat(e)),t}()});if(!r.ok){if(401===r.status)return localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/login",[];let e=r.headers.get("content-type");if(e&&e.includes("application/json")){let e=await r.json().catch(()=>({detail:r.statusText}));return console.error("Autocomplete API error:",r.status,e),[]}{let e=await r.text().catch(()=>r.statusText);return console.error("Autocomplete API error (HTML response):",r.status,e.substring(0,100)),[]}}let n=r.headers.get("content-type");if(!n||!n.includes("application/json")){let e=await r.text();throw console.error("Unexpected content type:",n,e.substring(0,100)),Error("Server returned non-JSON response")}let o=await r.json();if(o.error)return console.error("Backend error:",o.detail),[];if(Array.isArray(o))return o;return[]}catch(e){return console.error("Error fetching autocomplete suggestions:",e),e instanceof Error&&console.error("Error details:",e.message,e.stack),[]}}async function a(e,t){return console.warn("fetchPlaceDetails called but may not be fully implemented with backend proxy"),null}r.d(t,{F$:()=>n,GC:()=>a,ak:()=>o})},90109:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(14294).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},94446:(e,t,r)=>{"use strict";r.d(t,{s:()=>s,t:()=>a});var n=r(12115);function o(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function a(...e){return t=>{let r=!1,n=e.map(e=>{let n=o(e,t);return r||"function"!=typeof n||(r=!0),n});if(r)return()=>{for(let t=0;t<n.length;t++){let r=n[t];"function"==typeof r?r():o(e[t],null)}}}}function s(...e){return n.useCallback(a(...e),e)}}},e=>{e.O(0,[286,619,283,441,493,358],()=>e(e.s=71361)),_N_E=e.O()}]);