(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6048:(e,t,a)=>{"use strict";a.d(t,{q:()=>i});var l=a(12115),s=a(62833),r=a(80344),n=a(19247);function i(){let{user:e}=(0,s.A)(),[t,a]=(0,l.useState)(n.x),[i,o]=(0,l.useState)(!0),[c,d]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null),[x,h]=(0,l.useState)(null),[g,f]=(0,l.useState)(!1),[p,j]=(0,l.useState)(0),v=(0,l.useRef)(null),y=(0,l.useCallback)(async()=>{if(!e)return void o(!1);try{d(!0);let e=await (0,r.$q)();e&&e.length>0&&(a(e),h(new Date),m(null),f(!0),j(0),console.log("✓ Fetched ".concat(e.length," city rankings")))}catch(e){console.error("Error fetching city rankings:",e),m("Failed to fetch rankings. Using cached data."),f(!1),j(e=>e+1)}finally{d(!1),o(!1)}},[e]);return(0,l.useEffect)(()=>{if(!e){o(!1),console.log("⏸ Rankings: Waiting for authentication...");return}return y(),console.log("→ Starting rankings poll (every ".concat(60,"s)")),v.current=setInterval(()=>{y()},6e4),()=>{v.current&&(clearInterval(v.current),v.current=null)}},[e,y]),{rankings:t,loading:i,isRefreshing:c,error:u,lastUpdated:x,isConnected:g,connectionAttempts:p,refetch:(0,l.useCallback)(()=>{y()},[y])}}},13154:(e,t,a)=>{"use strict";a.d(t,{Hm:()=>p,II:()=>h,Nt:()=>g,_3:()=>f,at:()=>m});var l=a(95155),s=a(12115),r=a(26991),n=a(23508),i=a(7620),o=a(64269);let c={light:"",dark:".dark"},d=s.createContext(null);function u(){let e=s.useContext(d);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let m=s.forwardRef((e,t)=>{let{id:a,className:n,children:i,config:c,...u}=e,m=s.useId(),h="chart-".concat(a||m.replace(/:/g,""));return(0,l.jsx)(d.Provider,{value:{config:c},children:(0,l.jsxs)("div",{"data-chart":h,ref:t,className:(0,o.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...u,children:[(0,l.jsx)(x,{id:h,config:c}),(0,l.jsx)(r.u,{children:i})]})})});m.displayName="Chart";let x=e=>{let{id:t,config:a}=e,s=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return s.length?(0,l.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(c).map(e=>{let[a,l]=e;return"\n".concat(l," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[l,s]=e,r=(null==(t=s.theme)?void 0:t[a])||s.color;return r?"  --color-".concat(l,": ").concat(r,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},h=n.m,g=s.forwardRef((e,t)=>{let{active:a,payload:r,className:n,indicator:i="dot",hideLabel:c=!1,hideIndicator:d=!1,label:m,labelFormatter:x,labelClassName:h,formatter:g,color:f,nameKey:p,labelKey:v}=e,{config:y}=u(),N=s.useMemo(()=>{var e;if(c||!(null==r?void 0:r.length))return null;let[t]=r,a="".concat(v||t.dataKey||t.name||"value"),s=j(y,t,a),n=v||"string"!=typeof m?null==s?void 0:s.label:(null==(e=y[m])?void 0:e.label)||m;return x?(0,l.jsx)("div",{className:(0,o.cn)("font-medium",h),children:x(n,r)}):n?(0,l.jsx)("div",{className:(0,o.cn)("font-medium",h),children:n}):null},[m,x,r,c,h,y,v]);if(!a||!(null==r?void 0:r.length))return null;let b=1===r.length&&"dot"!==i;return(0,l.jsxs)("div",{ref:t,className:(0,o.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[b?null:N,(0,l.jsx)("div",{className:"grid gap-1.5",children:r.map((e,t)=>{let a="".concat(p||e.name||e.dataKey||"value"),s=j(y,e,a),r=f||e.payload.fill||e.color;return(0,l.jsx)("div",{className:(0,o.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:g&&(null==e?void 0:e.value)!==void 0&&e.name?g(e.value,e.name,e,t,e.payload):(0,l.jsxs)(l.Fragment,{children:[(null==s?void 0:s.icon)?(0,l.jsx)(s.icon,{}):!d&&(0,l.jsx)("div",{className:(0,o.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":b&&"dashed"===i}),style:{"--color-bg":r,"--color-border":r}}),(0,l.jsxs)("div",{className:(0,o.cn)("flex flex-1 justify-between leading-none",b?"items-end":"items-center"),children:[(0,l.jsxs)("div",{className:"grid gap-1.5",children:[b?N:null,(0,l.jsx)("span",{className:"text-muted-foreground",children:(null==s?void 0:s.label)||e.name})]}),e.value&&(0,l.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});g.displayName="ChartTooltip";let f=i.s,p=s.forwardRef((e,t)=>{let{className:a,hideIcon:s=!1,payload:r,verticalAlign:n="bottom",nameKey:i}=e,{config:c}=u();return(null==r?void 0:r.length)?(0,l.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center justify-center gap-4","top"===n?"pb-3":"pt-3",a),children:r.map(e=>{let t="".concat(i||e.dataKey||"value"),a=j(c,e,t);return(0,l.jsxs)("div",{className:(0,o.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==a?void 0:a.icon)&&!s?(0,l.jsx)(a.icon,{}):(0,l.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==a?void 0:a.label]},e.value)})}):null});function j(e,t,a){if("object"!=typeof t||null===t)return;let l="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,s=a;return a in t&&"string"==typeof t[a]?s=t[a]:l&&a in l&&"string"==typeof l[a]&&(s=l[a]),s in e?e[s]:e[a]}p.displayName="ChartLegend"},18450:(e,t,a)=>{Promise.resolve().then(a.bind(a,49073))},19247:(e,t,a)=>{"use strict";a.d(t,{x:()=>l});let l=[{rank:1,city:"Delhi",country:"India",aqi:182,category:"Unhealthy",dominantPollutant:"PM2.5",trend:[{time:"3h ago",aqi:175},{time:"2h ago",aqi:180},{time:"1h ago",aqi:182}],lastUpdated:"2 mins ago",region:"Asia"},{rank:2,city:"Lahore",country:"Pakistan",aqi:165,category:"Unhealthy",dominantPollutant:"PM2.5",trend:[{time:"3h ago",aqi:160},{time:"2h ago",aqi:162},{time:"1h ago",aqi:165}],lastUpdated:"5 mins ago",region:"Asia"},{rank:3,city:"Dhaka",country:"Bangladesh",aqi:155,category:"Unhealthy",dominantPollutant:"PM2.5",trend:[{time:"3h ago",aqi:150},{time:"2h ago",aqi:152},{time:"1h ago",aqi:155}],lastUpdated:"3 mins ago",region:"Asia"},{rank:4,city:"Jakarta",country:"Indonesia",aqi:152,category:"Unhealthy",dominantPollutant:"O₃",trend:[{time:"3h ago",aqi:148},{time:"2h ago",aqi:150},{time:"1h ago",aqi:152}],lastUpdated:"8 mins ago",region:"Asia"},{rank:5,city:"Kolkata",country:"India",aqi:140,category:"Moderate",dominantPollutant:"PM2.5",trend:[{time:"3h ago",aqi:135},{time:"2h ago",aqi:138},{time:"1h ago",aqi:140}],lastUpdated:"10 mins ago",region:"Asia"},{rank:6,city:"Mexico City",country:"Mexico",aqi:102,category:"Moderate",dominantPollutant:"O₃",trend:[{time:"3h ago",aqi:98},{time:"2h ago",aqi:100},{time:"1h ago",aqi:102}],lastUpdated:"12 mins ago",region:"North America"},{rank:7,city:"S\xe3o Paulo",country:"Brazil",aqi:78,category:"Moderate",dominantPollutant:"PM2.5",trend:[{time:"3h ago",aqi:75},{time:"2h ago",aqi:77},{time:"1h ago",aqi:78}],lastUpdated:"15 mins ago",region:"South America"},{rank:8,city:"Los Angeles",country:"USA",aqi:65,category:"Moderate",dominantPollutant:"NO₂",trend:[{time:"3h ago",aqi:60},{time:"2h ago",aqi:62},{time:"1h ago",aqi:65}],lastUpdated:"7 mins ago",region:"North America"},{rank:9,city:"London",country:"UK",aqi:45,category:"Good",dominantPollutant:"NO₂",trend:[{time:"3h ago",aqi:42},{time:"2h ago",aqi:43},{time:"1h ago",aqi:45}],lastUpdated:"4 mins ago",region:"Europe"},{rank:10,city:"Sydney",country:"Australia",aqi:30,category:"Good",dominantPollutant:"O₃",trend:[{time:"3h ago",aqi:28},{time:"2h ago",aqi:29},{time:"1h ago",aqi:30}],lastUpdated:"1 min ago",region:"Oceania"}]},36364:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var l=a(95155),s=a(12115),r=a(20063),n=a(62833),i=a(92033);function o(e){let{children:t,requireVerified:a=!1}=e,{user:o,loading:c,isAuthenticated:d}=(0,n.A)(),u=(0,r.useRouter)();return((0,s.useEffect)(()=>{!c&&(d?a&&o&&!o.is_verified&&u.push("/verify-email"):u.push("/login"))},[c,d,o,a,u]),c)?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsx)(i.A,{className:"h-8 w-8 animate-spin text-primary"})}):!d||a&&o&&!o.is_verified?null:(0,l.jsx)(l.Fragment,{children:t})}},49073:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>X});var l=a(95155),s=a(12115),r=a(71349),n=a(86948),i=a(3998),o=a(94368),c=a(62833),d=a(80344);let u={lat:40.7128,lng:-74.006},m={"New York":{lat:40.7128,lng:-74.006},London:{lat:51.5074,lng:-.1278},Tokyo:{lat:35.6762,lng:139.6503},Paris:{lat:48.8566,lng:2.3522},Delhi:{lat:28.6139,lng:77.209},Beijing:{lat:39.9042,lng:116.4074},"Los Angeles":{lat:34.0522,lng:-118.2437},Mumbai:{lat:19.076,lng:72.8777},"S\xe3o Paulo":{lat:-23.5505,lng:-46.6333},Cairo:{lat:30.0444,lng:31.2357},Sydney:{lat:-33.8688,lng:151.2093},"Mexico City":{lat:19.4326,lng:-99.1332},Karachi:{lat:24.8607,lng:67.0011},Lahore:{lat:31.5204,lng:74.3587}};var x=a(64065),h=a(94262),g=a(41922),f=a(24467),p=a(78770),j=a(92033),v=a(10639),y=a(76140),N=a(37915),b=a(66874);let k={"PM2.5":x.A,PM10:h.A,"NO₂":g.A,"O₃":f.A,CO:p.A,"SO₂":p.A};function w(e){let{city:t,coordinates:a,onResetToUserCity:r,isViewingUserCity:h=!0}=e,{aqiData:g,loading:p,error:w}=function(e){let t=(null==e?void 0:e.city)||"New York",a=null==e?void 0:e.coordinates,{user:l}=(0,c.A)(),[r,n]=(0,s.useState)(o.jj),[i,x]=(0,s.useState)(o.Fu),[h,g]=(0,s.useState)(!0),[f,p]=(0,s.useState)(null),[j,v]=(0,s.useState)(!0),[y,N]=(0,s.useState)(0),b=e=>a||m[e]||u;return(0,s.useEffect)(()=>{let e=!0,a=null,s=async()=>{if(!l)return void g(!1);try{g(!0),p(null),N(e=>e+1);let a=b(t),[l,s]=await Promise.allSettled([(0,d.fetchAQIByCoordinates)(a.lat,a.lng),(0,d.H0)(t)]);if(!e)return;if("fulfilled"===l.status&&l.value){let e=l.value;!e.city&&t&&(e.city=t),n(e),p(null),N(0),v(!1)}else r&&r.city&&r.aqi>0?(console.warn("Failed to fetch latest AQI data, using cached/fallback data"),p(null)):j?(console.error("Failed to fetch AQI data and no fallback available"),n({...o.jj,city:t||"Unknown Location"}),p("Failed to fetch latest AQI data. Please try again later.")):p(null),v(!1);"fulfilled"===s.status&&s.value?x(s.value):console.warn("Failed to fetch trend data, using fallback")}catch(t){e&&(console.error("Error fetching AQI data:",t),r&&r.city&&r.aqi>0?p(null):j?p("Error loading air quality data"):p(null),v(!1))}finally{e&&g(!1)}};return s(),a=setInterval(()=>{e&&s()},3e5),()=>{e=!1,a&&clearInterval(a)}},[t,a]),{aqiData:r,trendData:i,loading:h,error:f,retryCount:y,refetch:async()=>{g(!0),N(e=>e+1);let e=b(t),[a,l]=await Promise.allSettled([(0,d.fetchAQIByCoordinates)(e.lat,e.lng),(0,d.H0)(t)]);"fulfilled"===a.status&&a.value&&(n(a.value),p(null),N(0)),"fulfilled"===l.status&&l.value&&x(l.value),g(!1)}}}({city:t,coordinates:a}),q=g.city,{aqi:A,category:P,healthAdvice:M,pollutants:S,weather:C,lastUpdated:_,usEpaAqi:O,globalAqi:L,localAqi:I,pm25Concentration:U,dominantPollutant:D,aqiCategory:z,aqiColor:R}=g,E=(0,o.nu)(A),K=null!=O?O:A,F=R?(0,o.g0)(R):{};return p&&!q?(0,l.jsx)(n.Zp,{className:"glass overflow-hidden transition-all duration-300 hover:shadow-2xl",children:(0,l.jsx)(n.Wu,{className:"p-6 md:p-8 flex items-center justify-center min-h-[300px]",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,l.jsx)(j.A,{className:"size-8 animate-spin text-primary"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Loading air quality data..."})]})})}):(0,l.jsx)(n.Zp,{className:"glass overflow-hidden transition-all duration-300 hover:shadow-2xl",children:(0,l.jsxs)(n.Wu,{className:"p-6 md:p-8 grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8 items-center",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center md:border-r md:border-border/50 md:pr-8",children:[(0,l.jsxs)("div",{className:"relative w-40 h-40 md:w-48 md:h-48",children:[(0,l.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 36 36",children:[(0,l.jsx)("path",{className:"stroke-muted/30",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",strokeWidth:"2"}),(0,l.jsx)("path",{className:(0,o.Xb)(K),strokeDasharray:"".concat(K/500*100,", 100"),d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",strokeWidth:"2.5",strokeLinecap:"round"})]}),(0,l.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,l.jsx)("span",{className:"text-6xl font-bold ".concat(E),style:F,children:K}),(0,l.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"US EPA AQI"})]})]}),(0,l.jsxs)("div",{className:"text-center mt-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,l.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("h3",{className:"text-lg font-semibold",children:q||t||"Unknown City"}),!h&&r&&(0,l.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:r,className:"h-6 px-2 text-xs",title:"Reset to my city",children:[(0,l.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"My City"]})]}),(0,l.jsx)("h2",{className:"text-2xl font-semibold ".concat(E),style:F,children:z||P}),D&&(0,l.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Dominant: ",D]})]})]}),(0,l.jsxs)("div",{className:"md:col-span-2 flex flex-col gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-lg",children:M}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Last updated: ",_]}),p&&(0,l.jsx)(j.A,{className:"size-3 animate-spin text-muted-foreground"}),w&&!p&&(0,l.jsxs)("p",{className:"text-xs text-orange-500",children:["⚠ ",w]})]})]}),(0,l.jsxs)("div",{className:"grid gap-4 p-4 rounded-lg bg-muted/30 ".concat(null!=L||null!=I?"grid-cols-3":"grid-cols-1"),children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"US EPA AQI"}),(0,l.jsx)("p",{className:"text-2xl font-bold",style:F,children:K}),null!=U&&(0,l.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["PM2.5: ",U.toFixed(1)," \xb5g/m\xb3"]})]}),null!=L&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Global AQI"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-500",children:L})]}),null!=I&&(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Local AQI"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-indigo-500",children:I})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 text-sm",children:[S.map(e=>{let t=k[e.name]||x.A;return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(t,{className:"size-5 text-muted-foreground"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-semibold",children:[e.value," ",(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:e.unit})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:e.name})]})]},e.name)}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(N.A,{className:"size-5 text-muted-foreground"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-semibold",children:[C.temperature,"\xb0C"]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Temp"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(b.A,{className:"size-5 text-muted-foreground"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-semibold",children:[C.humidity,"%"]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Humidity"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(f.A,{className:"size-5 text-muted-foreground"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-semibold",children:[C.wind," km/h"]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"Wind"})]})]})]})]})]})})}var q=a(80019),A=a(68425),P=a(47734),M=a(73697),S=a(47643),C=a(13154);let _={aqi:{label:"PM2.5",color:"hsl(var(--chart-1))"}};function O(e){var t;let{data:a}=e,s=(null==a?void 0:a.hourly)||{},r=(null==(t=s.time)?void 0:t.slice(0,24).map((e,t)=>{var a;return{time:new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),aqi:(null==(a=s.pm2_5)?void 0:a[t])||0}}))||[];return(0,l.jsxs)(n.Zp,{className:"glass h-full transition-all duration-300 hover:shadow-2xl",children:[(0,l.jsxs)(n.aR,{children:[(0,l.jsxs)(n.ZB,{className:"text-xl flex items-center gap-2",children:["PM2.5 Trend (24h)",!a&&(0,l.jsx)(j.A,{className:"size-4 animate-spin text-muted-foreground"})]}),(0,l.jsx)(n.BT,{children:"Predicted PM2.5 fluctuation for the next 24 hours."})]}),(0,l.jsx)(n.Wu,{children:r.length>0?(0,l.jsx)(C.at,{config:_,className:"h-64 w-full",children:(0,l.jsxs)(q.b,{data:r,margin:{top:5,right:20,left:-20,bottom:5},children:[(0,l.jsx)(A.d,{strokeDasharray:"3 3",vertical:!1}),(0,l.jsx)(P.W,{dataKey:"time",tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12,minTickGap:30}),(0,l.jsx)(M.h,{tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12,domain:["dataMin - 10","dataMax + 10"]}),(0,l.jsx)(C.II,{cursor:{stroke:"hsl(var(--border))",strokeWidth:2,strokeDasharray:"3 3"},content:(0,l.jsx)(C.Nt,{})}),(0,l.jsx)(S.N,{type:"monotone",dataKey:"aqi",stroke:"var(--color-aqi)",strokeWidth:2,dot:!1})]})}):(0,l.jsx)("div",{className:"h-64 w-full flex items-center justify-center text-muted-foreground",children:"No trend data available"})})]})}let L={pm25:{label:"PM2.5 Forecast",color:"hsl(var(--chart-1))"}};function I(e){var t;let{data:a}=e,s=(null==a?void 0:a.hourly)||{},r=(null==(t=s.time)?void 0:t.slice(0,24).map((e,t)=>{var a;return{time:new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),pm25:(null==(a=s.pm2_5)?void 0:a[t])||0}}))||[];return(0,l.jsxs)(n.Zp,{className:"glass h-full transition-all duration-300 hover:shadow-2xl",children:[(0,l.jsxs)(n.aR,{children:[(0,l.jsxs)(n.ZB,{className:"text-xl flex items-center gap-2",children:["24h PM2.5 Forecast",!a&&(0,l.jsx)(j.A,{className:"size-4 animate-spin text-muted-foreground"})]}),(0,l.jsx)(n.BT,{children:"Predicted PM2.5 levels for the next 24 hours."})]}),(0,l.jsx)(n.Wu,{children:r.length>0?(0,l.jsx)(C.at,{config:L,className:"h-64 w-full",children:(0,l.jsxs)(q.b,{data:r,margin:{top:5,right:20,left:-20,bottom:5},children:[(0,l.jsx)(A.d,{strokeDasharray:"3 3",vertical:!1}),(0,l.jsx)(P.W,{dataKey:"time",tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12,minTickGap:30}),(0,l.jsx)(M.h,{tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12}),(0,l.jsx)(C.II,{content:(0,l.jsx)(C.Nt,{})}),(0,l.jsx)(C._3,{content:(0,l.jsx)(C.Hm,{})}),(0,l.jsx)(S.N,{type:"monotone",dataKey:"pm25",stroke:"var(--color-pm25)",strokeWidth:2,dot:!1})]})}):(0,l.jsx)("div",{className:"h-64 w-full flex items-center justify-center text-muted-foreground",children:"No forecast data available"})})]})}var U=a(10281),D=a(12235);let z={value:{label:"Value"},"PM2.5":{label:"PM2.5",color:"hsl(var(--chart-1))"},PM10:{label:"PM10",color:"hsl(var(--chart-2))"},"O₃":{label:"O₃",color:"hsl(var(--chart-3))"},"NO₂":{label:"NO₂",color:"hsl(var(--chart-4))"},"SO₂":{label:"SO₂",color:"hsl(var(--chart-5))"},CO:{label:"CO",color:"hsl(var(--primary))"}};function R(e){let{data:t}=e,a=(()=>{if(!(null==t?void 0:t.pollutants)||0===Object.keys(t.pollutants).length)return[];let e=["PM2.5","PM10","NO₂","O₃","CO","SO₂"],a=Object.values(t.pollutants),l=a.reduce((e,t)=>e+(t.value||0),0);return 0===l?[]:a.filter(t=>e.includes(t.name)).map(e=>({name:e.name,value:Math.round(e.value/l*100)})).filter(e=>e.value>0).slice(0,6)})();return(0,l.jsxs)(n.Zp,{className:"glass flex flex-col h-full transition-all duration-300 hover:shadow-2xl",children:[(0,l.jsxs)(n.aR,{children:[(0,l.jsxs)(n.ZB,{className:"text-xl flex items-center gap-2",children:["Pollutant Distribution",!t&&(0,l.jsx)(j.A,{className:"size-4 animate-spin text-muted-foreground"})]}),(0,l.jsx)(n.BT,{children:"Contribution of each pollutant to air quality."})]}),(0,l.jsx)(n.Wu,{className:"flex-1 pb-0",children:a.length>0?(0,l.jsx)(C.at,{config:z,className:"mx-auto aspect-square max-h-64",children:(0,l.jsxs)(U.r,{children:[(0,l.jsx)(C.II,{content:(0,l.jsx)(C.Nt,{nameKey:"name"})}),(0,l.jsx)(D.F,{data:a,dataKey:"value",nameKey:"name",innerRadius:50,outerRadius:80,paddingAngle:2}),(0,l.jsx)(C._3,{content:(0,l.jsx)(C.Hm,{nameKey:"name"}),className:"-translate-y-2 flex-wrap gap-2 [&>*]:basis-1/4 [&>*]:justify-center"})]})}):(0,l.jsx)("div",{className:"h-64 w-full flex items-center justify-center text-muted-foreground",children:"No pollutant data available"})})]})}var E=a(98128),K=a(23508),F=a(7620),W=a(16533);let B={o3:{label:"Ozone",color:"hsl(var(--chart-1))"},no2:{label:"NO₂",color:"hsl(var(--chart-2))"},pm25:{label:"PM2.5",color:"hsl(var(--chart-3))"}};function T(e){var t;let{data:a}=e,s=(null==a?void 0:a.daily)||{},r=(null==(t=s.time)?void 0:t.map((e,t)=>{var a,l,r;return{date:e,pm25:(null==(a=s.pm2_5)?void 0:a[t])||0,no2:(null==(l=s.nitrogen_dioxide)?void 0:l[t])||0,o3:(null==(r=s.ozone)?void 0:r[t])||0}}))||[];return(0,l.jsxs)(n.Zp,{className:"glass h-full transition-all duration-300 hover:shadow-2xl",children:[(0,l.jsxs)(n.aR,{children:[(0,l.jsxs)(n.ZB,{className:"text-xl flex items-center gap-2",children:["7-Day Forecast",!a&&(0,l.jsx)(j.A,{className:"size-4 animate-spin text-muted-foreground"})]}),(0,l.jsx)(n.BT,{children:"Expected levels of key pollutants for the next week."})]}),(0,l.jsx)(n.Wu,{children:r.length>0?(0,l.jsx)(C.at,{config:B,className:"h-64 w-full",children:(0,l.jsxs)(E.E,{data:r,margin:{left:-20,right:20},children:[(0,l.jsx)(A.d,{strokeDasharray:"3 3",vertical:!1}),(0,l.jsx)(P.W,{dataKey:"date",tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{weekday:"short"}),tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12}),(0,l.jsx)(M.h,{tickLine:!1,axisLine:!1,tickMargin:8,fontSize:12}),(0,l.jsx)(K.m,{content:(0,l.jsx)(C.Nt,{})}),(0,l.jsx)(F.s,{}),(0,l.jsx)(W.y,{dataKey:"o3",fill:"var(--color-o3)",radius:4,name:"Ozone"}),(0,l.jsx)(W.y,{dataKey:"no2",fill:"var(--color-no2)",radius:4,name:"NO2"}),(0,l.jsx)(W.y,{dataKey:"pm25",fill:"var(--color-pm25)",radius:4,name:"PM2.5"})]})}):(0,l.jsx)("div",{className:"h-64 w-full flex items-center justify-center text-muted-foreground",children:"No forecast data available"})})]})}var Z=a(6048),Q=a(33173),H=a(52619),G=a.n(H),V=a(19247);function Y(){let{rankings:e,loading:t,isRefreshing:a,isConnected:s}=(0,Z.q)(),r=e.length>0?e.slice(0,5):V.x.slice(0,5);return(0,l.jsxs)(n.Zp,{className:"glass h-full transition-all duration-300 hover:shadow-2xl",children:[(0,l.jsxs)(n.aR,{className:"flex flex-row items-center justify-between pb-4",children:[(0,l.jsxs)(n.ZB,{className:"text-xl flex items-center gap-2",children:["Live Most Polluted Cities",t&&(0,l.jsx)(j.A,{className:"size-4 animate-spin text-muted-foreground"}),!t&&s&&(0,l.jsxs)("span",{className:"flex h-2 w-2 relative",children:[(0,l.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),(0,l.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),!t&&!s&&!a&&(0,l.jsx)("span",{className:"flex h-2 w-2 rounded-full bg-yellow-500",title:"Reconnecting..."})]}),(0,l.jsx)(i.$,{variant:"ghost",size:"sm",asChild:!0,className:"group transition-all hover:gap-2",children:(0,l.jsxs)(G(),{href:"/city-rankings",className:"flex items-center gap-1",children:["View All ",(0,l.jsx)(Q.A,{className:"h-4 w-4 transition-transform group-hover:translate-x-1"})]})})]}),(0,l.jsx)(n.Wu,{children:(0,l.jsx)("ul",{className:"space-y-3",children:r.map((e,t)=>{var a,s;let r=null!=(s=null!=(a=e.aqi_pm25)?a:e.aqi_pm10)?s:e.aqi;return(0,l.jsxs)("li",{className:"flex items-center justify-between gap-4 p-2 rounded-lg transition-all hover:bg-accent/50 cursor-pointer group",style:{animationDelay:"".concat(.05*t,"s")},children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("span",{className:"flex h-2.5 w-2.5 shrink-0 rounded-full transition-all ".concat((0,o.nu)(r).replace("text-","bg-")," group-hover:scale-125")}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium group-hover:text-foreground transition-colors",children:e.city}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:e.country})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"font-bold text-lg transition-all group-hover:scale-110 ".concat((0,o.nu)(r)),children:r}),void 0!==e.aqi_pm10&&null!==e.aqi_pm10&&(0,l.jsxs)("p",{className:"text-xs text-muted-foreground ".concat((0,o.nu)(e.aqi_pm10)),children:["PM10: ",e.aqi_pm10]})]})]},"".concat(e.city,"-").concat(e.country))})})})]})}var $=a(36364);function X(){let{user:e}=(0,c.A)(),[t,a]=(0,s.useState)(null),[n,i]=(0,s.useState)(null),[o,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&!t&&e.city&&(a(e.city),e.latitude&&e.longitude&&i({lat:e.latitude,lng:e.longitude}))},[e,t]),(0,s.useEffect)(()=>{n?(async()=>{try{let e=await (0,d.cC)(n.lat,n.lng);u(e)}catch(e){console.error("Failed to fetch enhanced dashboard data:",e)}})():u(null)},[n]);let h=async()=>{if(null==e?void 0:e.city)if(a(e.city),e.latitude&&e.longitude)i({lat:e.latitude,lng:e.longitude}),x(null);else try{let t=await (0,d.CE)(e.city);t?(i({lat:t.latitude,lng:t.longitude}),x(null)):g()}catch(e){console.error("Error geocoding user city:",e),g()}else g()},g=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{i({lat:e.coords.latitude,lng:e.coords.longitude}),x(null),a("Current Location")},e=>{console.error("Error getting current location:",e),x("Unable to get your location. Please allow location access or search for a city.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.error("Geolocation is not supported by your browser"),x("Geolocation is not supported. Please search for a city."))};return(0,l.jsx)($.A,{children:(0,l.jsx)(r.A,{onCitySearch:(e,t)=>{a(e),i(t),x(null)},children:(0,l.jsx)("div",{className:"flex flex-col gap-6 md:gap-8 p-4 md:p-6 lg:p-8 max-w-7xl mx-auto w-full",children:(0,l.jsxs)("main",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8",children:[(0,l.jsx)("div",{className:"lg:col-span-3 animate-slide-up",children:(0,l.jsx)(w,{city:t||void 0,coordinates:n||void 0,onResetToUserCity:h,isViewingUserCity:t===(null==e?void 0:e.city)})}),(0,l.jsx)("div",{className:"lg:col-span-2 animate-slide-up",style:{animationDelay:"0.1s"},children:(0,l.jsx)(I,{data:o})}),(0,l.jsx)("div",{className:"animate-slide-up",style:{animationDelay:"0.15s"},children:(0,l.jsx)(Y,{})}),(0,l.jsx)("div",{className:"lg:col-span-2 animate-slide-up",style:{animationDelay:"0.2s"},children:(0,l.jsx)(O,{data:o})}),(0,l.jsx)("div",{className:"animate-slide-up",style:{animationDelay:"0.25s"},children:(0,l.jsx)(R,{data:o})}),(0,l.jsx)("div",{className:"lg:col-span-3 animate-slide-up",style:{animationDelay:"0.3s"},children:(0,l.jsx)(T,{data:o})})]})})})})}},86948:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>n,aR:()=>i});var l=a(95155),s=a(12115),r=a(64269);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},94368:(e,t,a)=>{"use strict";a.d(t,{Fu:()=>i,Xb:()=>s,g0:()=>r,jj:()=>n,nu:()=>l});let l=e=>e<=50?"text-primary":e<=100?"text-yellow-500":e<=150?"text-orange-500":e<=200?"text-red-500":e<=300?"text-purple-500":"text-red-700",s=e=>e<=50?"stroke-primary":e<=100?"stroke-yellow-500":e<=150?"stroke-orange-500":e<=200?"stroke-red-500":e<=300?"stroke-purple-500":"stroke-red-700",r=e=>e?{color:e}:{color:"inherit"},n={city:"New York",aqi:42,category:"Good",healthAdvice:"Air quality is good. It's a great day to be active outside.",pollutants:[{name:"PM2.5",value:8.7,unit:"\xb5g/m\xb3"},{name:"PM10",value:12.1,unit:"\xb5g/m\xb3"},{name:"NO₂",value:15.3,unit:"ppb"},{name:"O₃",value:30.5,unit:"ppb"},{name:"CO",value:.4,unit:"ppm"},{name:"SO₂",value:1.2,unit:"ppb"}],weather:{temperature:22,humidity:55,wind:10},lastUpdated:new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},i=[{time:"12 AM",aqi:45},{time:"3 AM",aqi:48},{time:"6 AM",aqi:50},{time:"9 AM",aqi:55},{time:"12 PM",aqi:60},{time:"3 PM",aqi:58},{time:"6 PM",aqi:52},{time:"9 PM",aqi:48}]}},e=>{e.O(0,[286,619,314,470,679,423,344,349,441,493,358],()=>e(e.s=18450)),_N_E=e.O()}]);